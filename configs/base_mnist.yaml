project:
  name: advance_score
  run_root: runs

dataset:
  name: mnist
  data_root: data
  batch_size: 128
  num_workers: 4
  pin_memory: true
  image_size: 28
  channels: 1

model:
  variant: baseline
  type: unet
  base_channels: 64
  channel_mults: [1, 2, 2]
  num_res_blocks: 2
  attn_resolutions: [14]
  sigma_embed_dim: 128
  dropout: 0.0
  preconditioning:
    type: edm
    sigma_data: 0.5
    sigma_eps: 1.0e-5

train:
  total_steps: 120000
  grad_accum_steps: 1
  amp: true
  lr: 2.0e-4
  betas: [0.9, 0.999]
  weight_decay: 0.01
  ema_decay: 0.999
  clip_grad_norm: 1.0
  log_every: 50
  ckpt_every: 5000
  ckpt_every_epochs: 10
  keep_last_k: 3
  selection_enable: true
  selection_eval_every: 100
  selection_top_k: 3
  selection_eval_nfe: 100
  selection_eval_num_samples: 2048
  selection_eval_batch_size: 128
  selection_sampler: heun
  selection_use_ema: true
  seed: 0

loss:
  objective: edm_denoiser
  sigma_sampling: edm_lognormal
  edm_p_mean: -1.2
  edm_p_std: 1.2
  sigma_sample_clamp: true
  sigma_data: 0.5
  weight_mode: sigma2
  sigma_min: 0.002
  sigma_max: 40.0
  lambda_sym: 0.0
  mu_loop: 0.0
  reg_k: 1
  reg_freq: 1
  reg_low_noise_only: false
  reg_low_noise_threshold: 0.2
  loop_delta: 0.01
  loop_sparse_ratio: 0.25

sampler:
  main: heun
  compare: [euler]
  nfe_list: [10, 20, 50, 100, 200]

eval:
  batch_size: 128
  num_fid_samples: 10000
  sigma_bins: 8
  integrability_batch: 128
  pathvar:
    enabled: false
    num_paths: 4
    num_segments: 6

logging:
  use_tensorboard: true
  csv_filename: metrics.csv

compute:
  device: auto
  cudnn_benchmark: true
  precision: amp
  target_gpu_hours: 12
